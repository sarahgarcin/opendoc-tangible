(function() {
  var phantom;

  phantom = require('phantom');

  phantom.create(function(ph) {
    ph.addCookie('cookie_name', 'cookie_value', 'localhost', function() {
      return console.log('Cookie was added');
    });
    return ph.createPage(function(page) {
      page.set('Referer', 'http://google.com');
      page.set('settings.userAgent', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1');
      return page.open("http://localhost:9901/cookie", function(status) {
        var finishedFunc, someFunc;
        console.log(status);
        someFunc = function(aaa, my_obj) {
          var attribute_to_want, h2Arr, results, x, _i, _ref;
          attribute_to_want = aaa;
          h2Arr = [];
          results = document.querySelectorAll(attribute_to_want);
          for (x = _i = 0, _ref = results.length; 0 <= _ref ? _i < _ref : _i > _ref; x = 0 <= _ref ? ++_i : --_i) {
            h2Arr.push(results[x].innerText);
          }
          return {
            h2: h2Arr,
            aaa: this["arguments"],
            obj: my_obj
          };
        };
        finishedFunc = function(result) {
          console.log(result);
          return ph.exit();
        };
        return page.evaluate(someFunc, finishedFunc, 'div', {
          wahtt: 111
        });
      });
    });
  });

}).call(this);
